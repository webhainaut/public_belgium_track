import locale
import logging
from datetime import datetime

from main.app.public_track_service import PublicTrackService

locale.setlocale(locale.LC_ALL, 'fr_BE.UTF-8')
logging.basicConfig(level=logging.INFO)


def main():
    public_track_service = PublicTrackService()

    # public_track_service.download(259209)

    # public_track_service.arrest_dao.delete_all(REFS)

    public_track_service.download_all(REF_ERROR)

    # public_track_service.print_to_excel_by_year(2024)

    # public_track_service.update_year(2024)
    # public_track_service.update_all(REFS)
    # public_track_service.download(259819)

    # print(public_track_service.read(259819))
    # print(public_track_service.read(259294).get(ROLE_NUMBER))
    # print(public_track_service.arrest_dao.search_refs_and(chamber="e"))
    # print(public_track_service.arrest_dao.search_refs_and(chamber="re"))

    # public_track_service.download(259507)
    # print(public_track_service.arrest_dao.search_refs_and(arrest_date=None))

    # public_track_service.print_to_excel_year(2024)
    # public_track_service.print_to_excel_all(REFS)
    # public_track_service.print_to_excel_all([259819])


# REFS = [260454, 260616]
# REFS = [247478, 255267, 255438, 255470, 255472, 255668, 255678, 255679, 255681, 255844, 255962, 255964, 256014, 256484,
#         256672, 257478, 257654, 257819, 257919, 257921, 258204, 255824, 258274, 255568, 258317, 256090, 256352, 256552,
#         256835, 256952, 257003, 255570, 257985, 257647, 257248, 257984, 258070, 257009, 258245, 256675, 261996, 258994,
#         259019, 259068, 259209]
# REFS = [259019, 259068, 259209]
# REFS = [258683, 259503, 259507, 259777, 259782, 259841, 259842, 260450, 260454, 260458, 260462, 260468, 260479, 260489,
#         260520, 260526, 260555, 260584, 260591, 261256, 261257, 261258, 261259, 261260, 261261, 261697, 261950, 261954,
#         261955, 262107]


# 2024
REFS = [259072, 258561, 261634, 260612, 260613, 260614, 260615, 260616, 259089, 258579, 258580, 259091, 259618, 260130,
        261666, 261669, 260135, 260137, 260138, 261171, 261172, 258613, 259126, 261173, 258616, 261174, 258620, 259644,
        259137, 261697, 259655, 261192, 259658, 260171, 259153, 259666, 260179, 261204, 258645, 258646, 258647, 258648,
        258649, 259159, 259672, 260182, 261552, 261553, 258662, 258664, 261229, 259192, 259193, 258683, 259710, 259711,
        261758, 261249, 261255, 261256, 259209, 261257, 261258, 259212, 259213, 261259, 261260, 261261, 258705, 258706,
        261775, 261778, 258713, 260768, 258721, 258722, 261281, 261282, 261283, 261285, 261286, 259753, 261804, 259250,
        261300, 260280, 260281, 260794, 260283, 260795, 260285, 259262, 260796, 261308, 259777, 259778, 259779, 259780,
        259781, 259782, 260291, 261826, 261827, 258762, 258763, 261836, 261837, 261332, 260309, 260824, 259289, 260825,
        260826, 259294, 258783, 258784, 258785, 258786, 260832, 261859, 260325, 259817, 261866, 259819, 261869, 261870,
        260335, 260336, 260337, 260338, 261361, 261871, 261872, 259830, 259831, 259832, 260343, 261881, 259835, 259836,
        259837, 259838, 261882, 259833, 259841, 259842, 259834, 261897, 261898, 258830, 258832, 261392, 259346, 259347,
        259348, 260372, 259350, 260373, 260375, 261913, 261915, 261406, 261407, 261408, 261409, 259875, 260900, 260901,
        260397, 258355, 258357, 261946, 260411, 261947, 259389, 261951, 261952, 259905, 260417, 261953, 261956, 259911,
        259917, 259918, 261973, 260440, 260442, 259419, 260443, 260955, 260448, 260450, 260454, 260458, 261996, 261997,
        260462, 261998, 261999, 258929, 258930, 262000, 260468, 262001, 259447, 260479, 259968, 259969, 262016, 258950,
        256903, 258952, 258953, 258954, 260489, 261001, 262026, 262034, 261309, 261024, 261025, 261026, 261536, 261537,
        261538, 260008, 260520, 260526, 259503, 259504, 258993, 258994, 259505, 259506, 259507, 259508, 259509, 260020,
        260021, 260532, 260533, 261561, 261563, 261564, 261573, 259526, 261574, 259019, 258508, 260555, 259023, 261074,
        262101, 262102, 260055, 260056, 261080, 262103, 262105, 262106, 262108, 259039, 261602, 259557, 259558, 260584,
        259561, 260073, 260585, 260591, 258546, 260087, 260088, 259066, 259067, 259068, 259069, 259070, 259071]

REF_ERROR = [260087, 260073, 261074, 261563, 261536, 258950, 259419, 259905, 261872, 261871, 261869, 260825, 260824,
             258762, 260285, 259193, 258613, ]

if __name__ == "__main__":
    start_time = datetime.now()
    main()
    end_time = datetime.now()
    execution_time = end_time - start_time
    print(f"Le script a pris {execution_time} secondes pour s'ex√©cuter.")
